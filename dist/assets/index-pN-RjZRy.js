(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function i(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(e){if(e.ep)return;e.ep=!0;const r=i(e);fetch(e.href,r)}})();const q=[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],G=[[[1,0,0],[1,1,1],[0,0,0]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]]],X=[[[0,0,1],[1,1,1],[0,0,0]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]]],Y=[[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]]],V=[[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[0,1,1],[0,0,1]],[[0,0,0],[0,1,1],[1,1,0]],[[1,0,0],[1,1,0],[0,1,0]]],J=[[[0,1,0],[1,1,1],[0,0,0]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]],K=[[[1,1,0],[0,1,1],[0,0,0]],[[0,0,1],[0,1,1],[0,1,0]],[[0,0,0],[1,1,0],[0,1,1]],[[0,1,0],[1,1,0],[1,0,0]]],B=20,E=10,S=30,w="#1b1b1b";function O(){return Array.from({length:B},()=>Array(E).fill(w))}function k(o,t,i,n,e){o.fillStyle=e,o.fillRect(t*n,i*n,n,n),o.strokeStyle="#333",o.strokeRect(t*n,i*n,n,n)}function L(o,t,i){t.forEach((n,e)=>n.forEach((r,l)=>k(o,l,e,i,r)))}function N(o,t,i,n){o.clearRect(0,0,t.width,t.height);const e=20,r=i[0].length,l=i.length,a=(t.width-r*e)/2,y=(t.height-l*e)/2+5;i.forEach((m,d)=>m.forEach((C,T)=>{C&&(o.fillStyle=n,o.fillRect(a+T*e,y+d*e,e,e),o.strokeStyle="#333",o.strokeRect(a+T*e,y+d*e,e,e))}))}function Q(o,t){o.fillStyle="rgba(0, 0, 0, 0.7)",o.fillRect(0,t.height/2-30,t.width,60),o.fillStyle="#FF4136",o.font="bold 30px Arial",o.textAlign="center",o.fillText("GAME OVER",t.width/2,t.height/2+10)}class U{constructor(t,i,n=0,e=t[0],r=3,l=-2){this.tetromino=t,this.color=i,this.tetrominoN=n,this.activeTetromino=e,this.x=r,this.y=l}fill(t,i){this.activeTetromino.forEach((n,e)=>{n.forEach((r,l)=>{r&&k(t,this.x+l,this.y+e,30,i)})})}draw(t){this.fill(t,this.color)}unDraw(t){this.fill(t,w)}moveDown(t,i,n){this.collision(0,1,i)?n():(this.unDraw(t),this.y++,this.draw(t))}moveRight(t,i){this.collision(1,0,i)||(this.unDraw(t),this.x++,this.draw(t))}moveLeft(t,i){this.collision(-1,0,i)||(this.unDraw(t),this.x--,this.draw(t))}rotate(t,i){const n=this.tetromino[(this.tetrominoN+1)%this.tetromino.length];let e=0;this.collision(0,0,i,n)&&(e=this.x>E/2?-1:1),this.collision(e,0,i,n)||(this.unDraw(t),this.x+=e,this.tetrominoN=(this.tetrominoN+1)%this.tetromino.length,this.activeTetromino=this.tetromino[this.tetrominoN],this.draw(t))}collision(t,i,n,e=this.activeTetromino){return e.some((r,l)=>r.some((a,y)=>{if(!a)return!1;const m=this.x+y+t,d=this.y+l+i;return m<0||m>=E||d>=B?!0:d<0?!1:n[d][m]!==w}))}}const b=document.getElementById("tetris"),f=b.getContext("2d"),F=document.getElementById("next-piece"),P=F.getContext("2d"),W=document.getElementById("score"),Z=document.getElementById("lines"),j=document.getElementById("level"),D=[[K,"#FF4136"],[V,"#2ECC40"],[J,"#B10DC9"],[Y,"#FFDC00"],[X,"#FF851B"],[q,"#0074D9"],[G,"#7FDBFF"]];let s=O(),c,h,I=0,v=0,p=1,u=!1,g=0;const x=500;function A(){const o=Math.floor(Math.random()*D.length);return new U(D[o][0],D[o][1])}function M(){W.innerText=I.toString(),Z.innerText=v.toString(),j.innerText=p.toString()}function R(){const o=Date.now();o-g>x/p&&(c.moveDown(f,s,()=>{let t=!1;if(c.activeTetromino.forEach((i,n)=>{i.forEach((e,r)=>{if(!e)return;const l=c.y+n,a=c.x+r;l<0?t=!0:s[l][a]=c.color})}),t){u=!0,L(f,s,S),Q(f,b);return}for(let i=0;i<B;i++)s[i].every(n=>n!==w)&&(s.splice(i,1),s.unshift(Array(E).fill(w)),I+=10,v++,p=Math.floor(v/10)+1);L(f,s,S),M(),c=h,h=A(),N(P,F,h.activeTetromino,h.color)}),g=o),u||requestAnimationFrame(R)}function H(){s=O(),L(f,s,S),c=A(),h=A(),N(P,F,h.activeTetromino,h.color),I=0,v=0,p=1,u=!1,M(),g=Date.now(),R()}document.getElementById("play")?.addEventListener("click",()=>H());document.getElementById("pause")?.addEventListener("click",()=>{u=!u,u||R()});document.getElementById("restart")?.addEventListener("click",()=>location.reload());["left","right","rotate","down"].forEach(o=>{document.getElementById(o)?.addEventListener("click",()=>{o==="left"?c.moveLeft(f,s):o==="right"?c.moveRight(f,s):o==="rotate"?c.rotate(f,s):o==="down"&&c.moveDown(f,s,()=>{}),g=Date.now()})});document.addEventListener("keydown",o=>{o.key==="ArrowLeft"?c.moveLeft(f,s):o.key==="ArrowRight"?c.moveRight(f,s):o.key==="ArrowUp"?c.rotate(f,s):o.key==="ArrowDown"&&c.moveDown(f,s,()=>{}),g=Date.now()});
